{% extends 'base.html.twig' %}

{% block title %}Hello LibraryController!{% endblock %}

{% block body %}
    <style>
        .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
    </style>

    {% block javascripts %}
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                var rows = document.querySelectorAll(".clickable-row");
                rows.forEach(function(row) {
                    row.addEventListener("click", function() {
                    var bookId = row.dataset.bookId;
                    window.location.href = "{{ path('book_show_by_id') }}" + "?bookId=" + bookId;
                    });
                });
            });
        </script>
    {% endblock %}

    <div class="books-table">
        <h1>Books: </h1>

        <table>
            <thead>
                <tr>
                    <th> Id </th>
                    <th> Name </th>
                    <th> Author </th>
                    <th> Image </th>
                </tr>
            </thead>

            <tbody>
                {% for book in books %}
                    <tr class="clickable-row" data-book-id="{{ book.id }}">
                            {# {% dump(book.id) %} #}
                            <td>{{ book.id }}</td>
                            <td>{{ book.name }}</td>
                            <td>{{ book.author }}</td>
                            <td>
                                {# Debug the value of book.image #}
                                {# {% dump(book.image) %} #}
                                {% if book.image %}
                                    <img src="{{ asset(book.image) }}" alt="{{ book.name }}" width="50">
                                {% else %}
                                    No Image Provided
                                {% endif %}
                            </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="w3-bar">
        <a href="{{ path('create_book_form') }}"><button class="w3-bar-item w3-button w3-teal">Create Book</button></a>
        <a href="{{ path('update_book_form') }}"><button class="w3-bar-item w3-button w3-blue">Update Book</button></a>
        <a href="{{ path('delete_book_form') }}"><button class="w3-bar-item w3-button w3-red">Delete Book</button></a>
    </div>
{% endblock %}
